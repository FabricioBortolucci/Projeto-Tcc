<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Relatório de Pessoas - Oficina</title>
    <link rel="stylesheet" type="text/css" media="all" th:href="@{/css/bootstrap.min.css}"/>
    <link rel="stylesheet" type="text/css" media="all" th:href="@{/images/bootstrap-icons.css}"/>
    <style>
        body {
            background-color: #f8f9fa;
        }

        /* Estilos adicionais podem ser adicionados aqui se necessário */
    </style>
</head>
<body>
<div class="d-flex">
    <div th:insert="~{fragments/sidebar}"></div>

    <main class="main-content-옆-sidebar-fixed d-flex flex-column w-100 min-vh-100 p-3 p-md-4 overflow-auto gap-3">

        <h1 class="h3 mb-0">Relatório de Pessoas</h1>

        <div class="card shadow-sm">
            <div class="card-header bg-light py-3">
                <h5 class="mb-0 fw-semibold"><i class="bi bi-filter me-2"></i>Filtros do Relatório</h5>
            </div>
            <div class="card-body p-4">
                <form th:action="@{/relatorios/pes-gerar}" method="get">

                    <fieldset class="mb-4">
                        <legend class="col-form-label pt-0 fs-6 fw-semibold">Filtrar por Tipo de Vínculo:</legend>
                        <div class="d-flex flex-wrap gap-3 align-items-center">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="checkTodosTipos" checked>
                                <label class="form-check-label fw-bold" for="checkTodosTipos">Todos os Tipos</label>
                            </div>
                            <div class="vr mx-2 d-none d-sm-block"></div>

                            <div class="form-check">
                                <input class="form-check-input tipo-pessoa-check" type="checkbox" name="tipos"
                                       value="CLIENTE" id="checkCliente" checked>
                                <label class="form-check-label" for="checkCliente">Cliente</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input tipo-pessoa-check" type="checkbox" name="tipos"
                                       value="FORNECEDOR" id="checkFornecedor" checked>
                                <label class="form-check-label" for="checkFornecedor">Fornecedor</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input tipo-pessoa-check" type="checkbox" name="tipos"
                                       value="FUNCIONARIO" id="checkFuncionario" checked>
                                <label class="form-check-label" for="checkFuncionario">Funcionário</label>
                            </div>
                        </div>
                    </fieldset>

                    <fieldset class="mb-3">
                        <legend class="col-form-label pt-0 fs-6 fw-semibold">Filtrar por Status:</legend>
                        <div class="form-check form-switch">
                            <input type="checkbox" class="form-check-input" id="apenasAtivo" name="apenasAtivo" checked>
                            <label class="form-check-label" for="apenasAtivo">Mostrar apenas pessoas ativas</label>
                        </div>
                    </fieldset>

                    <div class="col-12 pt-3 mt-3 border-top d-flex justify-content-end gap-2">
                        <a th:href="@{/relatorios/pesRel}" class="btn btn-outline-secondary">
                            <i class="bi bi-eraser me-1"></i> Limpar Filtros
                        </a>
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-file-earmark-pdf-fill me-1"></i> Gerar Relatório
                        </button>
                    </div>

                </form>
            </div>
        </div>
    </main>
</div>

<script type="text/javascript" th:src="@{/js/bootstrap.bundle.min.js}"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const checkTodos = document.getElementById('checkTodosTipos');
        const checkTipos = document.querySelectorAll('.tipo-pessoa-check');

        // Função para atualizar o checkbox "Todos" com base nos outros
        function atualizarCheckTodos() {
            // Se todos os checkboxes de tipo estiverem marcados, marca o "Todos". Senão, desmarca.
            const todosMarcados = Array.from(checkTipos).every(checkbox => checkbox.checked);
            checkTodos.checked = todosMarcados;
        }

        // Evento para o checkbox "Todos"
        checkTodos.addEventListener('change', function () {
            // Marca ou desmarca todos os outros checkboxes de tipo
            checkTipos.forEach(checkbox => {
                checkbox.checked = this.checked;
            });
        });

        // Evento para os checkboxes individuais de tipo
        checkTipos.forEach(checkbox => {
            checkbox.addEventListener('change', function () {
                atualizarCheckTodos();
            });
        });

        // Garante o estado inicial correto ao carregar a página
        atualizarCheckTodos();
    });
</script>
</body>
</html>