<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Pessoas - Oficina</title>
    <link rel="stylesheet" type="text/css" media="all"
          href="/css/bootstrap.min.css" th:href="@{/css/bootstrap.min.css}"/>
</head>
<body>
<th:block th:fragment="fornecedorForm">

    <div id="fornecedorInput" class="mb-3 d-flex align-items-center">
        <label class="form-label me-2 mb-0" for="fornecedor">Fornecedor:</label>

        <select class="form-select w-auto border-dark" id="fornecedor" name="fornecedor">
            <option value="">Selecione um fornecedor</option>
            <option th:each="fornecedor : ${forn_list}"
                    th:value="${fornecedor.id}"
                    th:text="${fornecedor.pesNome}"></option>
        </select>

        <button type="button" class="btn btn-primary ms-2"
                th:hx-post="@{/produto/cadastro/adicionar}"
                hx-target="#tabelaContainer"
                hx-include="#fornecedor"
                hx-swap="outerHTML">
            Adicionar
        </button>
    </div>


    <div id="tabelaContainer" th:fragment="fornecedorTable" class="mb-3">
        <table class="table table-dark table-bordered table-hover table-striped table-responsive table-sm ">
            <thead class="table-dark text-center">
            <tr>
                <th>Nome</th>
                <th>Último Fornecimento</th>
                <th>Telefone Principal</th>
                <th>Opções</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="fo, iter : ${fornecedores}" th:id="'fornecedor-' + ${iter.index}">
                <td th:text="${fo.pesNome}"></td>
                <td th:text="${fo.dataUltimoFornecimento == null ? 'N/A' : fo.dataUltimoFornecimento}"></td>
                <td th:text="${fo.telefonePrincipal}"></td>
                <td class="text-center">
                    <button class="btn btn-sm btn-danger"
                            th:hx-delete="@{/produto/cadastro/remover/{index}(index=${iter.index})}"
                            hx-target="#tabelaContainer"
                            hx-swap="outerHTML">
                        Remover
                    </button>
                </td>
            </tr>
            </tbody>
        </table>

    </div>

</th:block>


<script type="text/javascript" th:src="@{/js/bootstrap.bundle.min.js}"></script>
<script th:src="@{/js/htmx/htmx.min.js}"></script>
</body>
</html>